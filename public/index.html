<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login & Profile Demo</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 500px; margin: auto; }
    input, button { padding: 0.5rem; margin: 0.5rem 0; width: 100%; }
    #profile { margin-top: 1rem; background: #f4f4f4; padding: 1rem; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>ƒêƒÉng nh·∫≠p</h2>
  <input id="username" placeholder="T√™n ƒëƒÉng nh·∫≠p" />
  <input id="password" placeholder="M·∫≠t kh·∫©u" type="password" />
  <button onclick="login()">ƒêƒÉng nh·∫≠p</button>

  <div id="profile" hidden>
    <h3>Th√¥ng tin ng∆∞·ªùi d√πng</h3>
    <pre id="profileData"></pre>
  </div>

  <script>
    const workerURL = 'https://score-backend.hoangngocthach-cntt.workers.dev/'; // üîÅ ƒë·ªïi th√†nh URL th·ª±c t·∫ø c·ªßa b·∫°n

    async function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      const res = await fetch(workerURL + '/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username, password })
      });

      if (res.ok) {
        const data = await res.json();
        localStorage.setItem('token', data.token);
        alert("ƒêƒÉng nh·∫≠p th√†nh c√¥ng!");
        loadProfile();
      } else {
        alert("Sai th√¥ng tin ƒëƒÉng nh·∫≠p!");
      }
    }

    async function loadProfile() {
      const token = localStorage.getItem('token');
      const res = await fetch(workerURL + '/profile', {
        headers: { 'Authorization': 'Bearer ' + token }
      });

      if (res.ok) {
        const data = await res.json();
        document.getElementById('profileData').textContent = JSON.stringify(data, null, 2);
        document.getElementById('profile').hidden = false;
      } else {
        alert("Kh√¥ng th·ªÉ t·∫£i th√¥ng tin ng∆∞·ªùi d√πng.");
      }
    }
  </script>
</body>
</html>
